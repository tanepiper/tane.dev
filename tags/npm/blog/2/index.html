<!doctype html><html lang=en-gb prefix="og: https://ogp.me/ns#"><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.145.0"><title>NPM - Development tutorials for modern web development</title>
<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,800" rel=stylesheet><link rel=stylesheet href=https://pro.fontawesome.com/releases/v5.7.2/css/all.css integrity=sha384-6jHF7Z3XI3fF4XZixAuSu0gGKrXwoX/w3uFPxC56OtjChio7wtTGJWRW53Nhx6Ev crossorigin=anonymous><link rel=stylesheet href=https://tane.dev/css/bundle.min.c2e4851d86d378b94d217eb138010f3338a9a41dbe246b7dc2c3fb5364d00a978fd2595df8bb2d30354eae35fd3895f5c7724e01082268c043ba77f50a56e091.css integrity="sha512-wuSFHYbTeLlNIX6xOAEPMzippB2+JGt9wsP7U2TQCpeP0lld+LstMDVOrjX9OJX1x3JOAQgiaMBDunf1ClbgkQ=="><link rel=alternate type=application/rss+xml href=https://tane.dev/tags/npm/index.xml title=tane.dev><meta property="og:image" content="https://www.mugshotbot.com/m?mode=light&theme=two_up&pattern=lines_in_motion&image=d3d350d5&hide_watermark=true&url=https://tane.dev/tags/npm/"><meta name=twitter:image content="https://www.mugshotbot.com/m?mode=light&theme=two_up&pattern=lines_in_motion&image=d3d350d5&hide_watermark=true&url=https://tane.dev/tags/npm/"><meta property="og:title" content="NPM"><meta name=twitter:title content="NPM"><meta name=twitter:card content="summary_large_image"><meta property="og:description" content="Development tutorials for modern web development"><meta name=twitter:description content="Development tutorials for modern web development"><meta property="og:url" content="https://tane.dev/tags/npm/"><meta property="og:site_name" content="tane.dev"><meta property="og:type" content="website"><script src=https://cdn.usefathom.com/script.js data-site=HNGWYVWJ defer></script><link rel=webmention href=https://webmention.io/tane.dev/webmention><link rel=pingback href=https://webmention.io/tane.dev/xmlrpc><meta name=msvalidate.01 content="33A8CFE8ACA5056A4E6D626DE029C0FE"></head><body class=light><div class=container-left><div class=row><div class="column sidebar"><div class=sidebar-content><h1 class="site-title flex-item flex-start" title="The title of the site tane.dev - click it to go back to the homepage" aria-label="The title of the site tane.dev - click it to go back to the homepage"><a href=https://tane.dev/ title="Click here to go back to the home page">tane.dev</a></h1><h2 class="flex-item subtitle" title="The subtitle of the site, is has a brain in it which makes the assumption the author has one" aria-label="The subtitle of the site, is has a brain in it which makes the assumption the author has one">[ <i class="far fa-head-side-brain"></i> ideas <sup>& stuff</sup> ]</h2><aside class=menu><ul class="sidebar-menus menu-list"><li>&#187; <a href=https://tane.dev/about>About</a></li><li>&#187; <a href=https://tane.dev/projects>Projects</a></li></ul><h3 class=menu-label title="A recent list of posts I've somehow managed to write down"><i class="far fa-keyboard"></i> Recent Posts:</h3><ul class=previous-posts><li><a href=https://tane.dev/2025/09/oh-no-not-again...-a-meditation-on-npm-supply-chain-attacks/>Oh no, not again... a meditation on NPM supply chain attacks</a>
<span>Published: Sep 9, 2025</span></li><li><a href=https://tane.dev/2023/09/slack-wants-you-you-know-this-privacy-exploit-is-fine/>Slack wants you you know this privacy exploit is fine</a>
<span>Published: Sep 25, 2023</span></li><li><a href=https://tane.dev/2023/04/i-think-i-found-a-privacy-exploit-in-chatgpt/>I Think I Found a Privacy Exploit in ChatGPT</a>
<span>Published: Apr 14, 2023</span></li><li><a href=https://tane.dev/2021/02/announcing-formula-a-zero-config-reactive-forms-library-for-svelte/>Announcing Formula - A Zero-Config Reactive Forms Library for Svelte</a>
<span>Published: Feb 13, 2021</span></li><li><a href=https://tane.dev/2021/02/revisiting-dark-patterns-with-the-html-dialog-tag/>Revisiting Dark patterns with the HTML &lt;dialog> tag</a>
<span>Published: Feb 8, 2021</span></li></ul><a href=https://tane.dev/archive>All Previous Posts &rang;</a><div class=feed><a href=https://tane.dev//index.xml><i class="far fa-rss-square"></i>&nbsp;RSS Feed</a></div></aside><div class=service-buttons><a class=flex-item href=https://github.com/tanepiper title="Link to my Github" target=_new rel=me><i class='fab fa-github-alt'></i></a>
<a class=flex-item href=https://linkedin.com/in/tanepiper title="Link to my LinkedIn" target=_new rel=me><i class='fab fa-linkedin'></i></a>
<a class=flex-item href=https://tane.codes/@tanepiper title="Link to my Mastodon" target=_new rel=me><i class='fab fa-mastodon'></i></a></div><footer class=footer><div class="flex-item contact"><i class="far fa-copyright"></i>&nbsp;2025 Tane Piper
<a href=mailto: title="I promise I check this from time to time" aria-label="I promise I check this from time to time"><i class="far fa-mailbox"></i>&nbsp;Email into the void</a></div><div class="flex-item meta"><div><i class="fas fa-hammer"></i>&nbsp;Site built with <a href=http://gohugo.io>Hugo</a> 0.145.0 <a href=https://tane.dev//about title="Click on this link to go to the about page"><sup>[about]</sup></a></div><div><i class="far fa-business-time"></i> Last modified 2025-09-10 09:07</div></div></footer><div class=theme-buttons><div class="flex-item button-group-label">Theme:</div><button class="flex-item btn btn-circle btn-theme btn-light" data-theme=light title="Click this button for the light theme" aria-label="Click this button for the light theme">
<button class="flex-item btn btn-circle btn-theme btn-dark" data-theme=dark title="Click this button for the dark theme" aria-label="Click this button for the dark theme">
<button class="flex-item btn btn-circle btn-theme btn-darkgreen" data-theme=darkgreen title="Click this button for the darkgreen theme" aria-label="Click this button for the darkgreen theme"></div></div><style type=text/css>.previous-posts li{flex-direction:column}.previous-posts li span{margin-left:.5rem;border-left:1px solid #d3d3d3;justify-content:right}</style></div><main class="column main"><h2 class=taxonomy-title title="The taxonomy of this page is NPM" aria-label="The taxonomy of this page is NPM">NPM</h2><div class=post><div class=post-heading><h1><a href=https://tane.dev/2021/01/rxjs-ninja-updates-new-operators-for-math-and-working-with-streams/>RxJS Ninja Updates - New operators for math and working with streams</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: Jan 14, 2021</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 300 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 2 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/typescript>TypeScript</a>
<a class=flex-item href=https://tane.dev/tags/rxjs>RxJS</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a>
<a class=flex-item href=https://tane.dev/tags/ecmascript>ECMAScript</a></div></div><div class=post-content><p>Since the last update on <a href=https://rxjs.ninja target=_blank>RxJS Ninja</a>
there have been a few new operators added, below are some details
and links to StackBlitz demos showing them in action.</p><h3 id=numbers-and-math-operators>Numbers and Math operators</h3><p>In <code>@rxjs-ninja/rxjs-number</code> the missing <a href=https://rxjs.ninja/modules/number.html#tofixed target=_blank>toFixed</a>
operator has been
added, alongside a new custom <a href=https://rxjs.ninja/modules/number.html#tohex target=_blank>toHex</a>
operator and the
corresponding <a href=https://rxjs.ninja/modules/number.html#parsehex target=_blank>parseHex</a>
one allowing hex numbers to be worked with (
such as converting colours)</p><p>There are also new operators for some basic math - <a href=https://rxjs.ninja/modules/number.html#add target=_blank>add</a>
, <a href=https://rxjs.ninja/modules/number.html#sub target=_blank>sub</a>
, <a href=https://rxjs.ninja/modules/number.html#div target=_blank>div</a>
,
<a href=https://rxjs.ninja/modules/number.html#mul target=_blank>mul</a>
, <a href=https://rxjs.ninja/modules/number.html#mod target=_blank>mod</a>
and
<a href=https://rxjs.ninja/modules/number.html#pow target=_blank>pow</a>
all allowing you to modify source numbers, all accept a number, or an
Observable number source.</p><h3 id=working-with-browser-streams>Working with Browser Streams</h3><p>Some new operators have been added to <code>@rxjs-ninja/rxjs-utility</code> that allow interoperability between <a href=http://rxjs.dev target=_blank>RxJS</a>
and the <a href=https://developer.mozilla.org/en-US/docs/Web/API/Streams_API target=_blank>StreamsAPI</a>
. These APIs are not in all browsers
but there is an available <a href=https://www.npmjs.com/package/web-streams-polyfill target=_blank>polyfill</a>
.</p><h4 id=fromreadablestream><code>fromReadableStream</code></h4><p>This <a href=https://rxjs.ninja/modules/utility.html#fromreadablestream target=_blank>operator</a>
accepts a <a href=https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream target=_blank>ReadableStream</a>
and provides the emitted values as an Observable, allowing you to use RxJS operators to work with the data.</p><ul><li><a href=https://stackblitz.com/edit/rxjs-readable-stream-fetch target=_blank>Demo</a>
- Using <code>fetch</code> body with <code>fromReadableStream</code> to show
partial images</li><li><a href=https://stackblitz.com/edit/rxjs-readable-stream target=_blank>Demo</a>
- A basic infinite number stream that ticks per second</li></ul><h4 id=towritablestream><code>toWritableStream</code></h4><p>This <a href=https://rxjs.ninja/modules/utility.html#towritablestream target=_blank>operator</a>
accepts a <a href=https://developer.mozilla.org/en-US/docs/Web/API/WritableStream target=_blank>WritableStream</a>
.
The operator emits the source value and also writes to the stream. The operator takes care of closing the writer when the
Observable subscription is closed.</p><ul><li><a href=https://stackblitz.com/edit/rxjs-writable-stream target=_blank>Demo</a>
- Streams an Observable interval value into a <code>WritableStream</code>
with optional ability to stop the writer without ending the Observable subscription.</li></ul><h4 id=fromfetchwithprogress><code>fromFetchWithProgress</code></h4><p>This <a href=https://rxjs.ninja/modules/utility.html#fromfetchwithprogress target=_blank>operator</a>
uses <code>fetch</code> to do a HTTP request, instead
of the body response it emits either a <code>number</code> which is the current progress, or a <code>Uint8Array</code> containing the final
response from the body.</p><ul><li><a href=https://stackblitz.com/edit/fetch-with-progress target=_blank>Demo</a>
Fetches an image and shows a progress bar with the current percentage
and once complete shows the image.</li></ul></div></div><div class=post><div class=post-heading><h1><a href=https://tane.dev/2020/11/rxjs-primitives-is-now-rxjs-ninja/>RxJS Primitives is now RxJS Ninja</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: Nov 23, 2020</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 100 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 1 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/typescript>TypeScript</a>
<a class=flex-item href=https://tane.dev/tags/rxjs>RxJS</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a>
<a class=flex-item href=https://tane.dev/tags/ecmascript>ECMAScript</a></div></div><div class=post-content><p><img src=https://raw.githubusercontent.com/rxjs-ninja/rxjs-ninja/main/assets/logo.png alt="RxJS Ninja Logo is a Ninja jumping over a crescent moon"></p><p>Today I&rsquo;ve re-released RxJS Primitives as <a href=https://rxjs.ninja target=_blank>RxJS Ninja</a>
. The new libraries have been published as the same last versions
under their old name, so it&rsquo;s easy to migrate to the new version - all now published under <code>@rxjs-ninja</code> instead of <code>@tinynodes</code>
(a deprecation notice has also been left the old packages).</p></div></div><div class=post><div class=post-heading><h1><a href=https://tane.dev/2020/11/new-rxjs-primitives-release-new-operators--typescript-4/>New RxJS Primitives release, new operators + Typescript 4</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: Nov 18, 2020</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 800 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 4 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/typescript>TypeScript</a>
<a class=flex-item href=https://tane.dev/tags/rxjs>RxJS</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a>
<a class=flex-item href=https://tane.dev/tags/ecmascript>ECMAScript</a></div></div><div class=post-content><p>This week I released new versions of my <a href=https://github.com/ReactiveX/rxjs target=_blank>RxJS</a>
libraries in <a href=https://github.com/tanepiper/rxjs-primitives target=_blank>rxjs-primitives</a>
.
Since it&rsquo;s released I&rsquo;ve added a few new utility operators. Some of these have been out for a while since I originally wrote about the release, so I&rsquo;ve highlighted them here as they may be useful to some developers.</p><p>You can check out the <a href=https://tanepiper.github.io/rxjs-primitives target=_blank>full docs here</a>
.</p><h3 id=typescript-4>Typescript 4</h3><p>Upgrading to Typescript 4 has allowed the removal of <a href=http://tane.dev/2020/05/polymorphic-typescript-function-overloading-with-rest-parameters/ target=_blank>polymorphic functions</a>
in place of
<a href=https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-0.html target=_blank>Vardic Tuple Types</a>
and is why there is a major bump on all packages.</p><p>This can be seen in the <a href=https://github.com/tanepiper/rxjs-primitives/blob/0f7d8f5c9bb5c6b9e6d1bc149ba661a464c52018/libs/rxjs/string/src/lib/concat.ts target=_blank>old</a>
and <a href=https://github.com/tanepiper/rxjs-primitives/blob/master/libs/rxjs/string/src/lib/concat.ts target=_blank>new</a>
<code>concat</code> operator in the <code>rxjs-string</code> package.</p><p>Most of the tests have also been converted to <a href=https://www.npmjs.com/package/rxjs-marbles target=_blank>rxjs-marbles</a>
allowing for more robust
Observable testing (if you are working with RxJS I highly recommend checking it out, it integrates well with runners like Jest).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>it</span>(
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;should return string value of string ending with passed character&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>marbles</span>((<span style=color:#a6e22e>m</span>) <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>input</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>hot</span>(<span style=color:#e6db74>&#39;-a-b-c-|&#39;</span>, { <span style=color:#a6e22e>a</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;test&#39;</span>, <span style=color:#a6e22e>b</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;testing&#39;</span>, <span style=color:#a6e22e>c</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;gone&#39;</span> });
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>subs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;^------!&#39;</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>expected</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>cold</span>(<span style=color:#e6db74>&#39;---y---|&#39;</span>, { <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;testing&#39;</span> });
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>input</span>.<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>filterEndsWith</span>(<span style=color:#e6db74>&#39;g&#39;</span>))).<span style=color:#a6e22e>toBeObservable</span>(<span style=color:#a6e22e>expected</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>m</span>.<span style=color:#a6e22e>expect</span>(<span style=color:#a6e22e>input</span>).<span style=color:#a6e22e>toHaveSubscriptions</span>(<span style=color:#a6e22e>subs</span>);
</span></span><span style=display:flex><span>    }),
</span></span><span style=display:flex><span>  );
</span></span></code></pre></div><h3 id=rxjs-array>rxjs-array</h3><blockquote><p>npm install @tinynodes/rxjs-array</p></blockquote><p>In the <a href=https://tanepiper.github.io/rxjs-primitives/modules/array.html target=_blank>array module</a>
there are some operators to use with finding
the difference or intersection between a source and a passed array, for example:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>of</span>([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>])
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>difference</span>([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;c&#39;</span>]))
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// [&#39;b&#39;, &#39;d&#39;]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>of</span>([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;b&#39;</span>, <span style=color:#e6db74>&#39;d&#39;</span>])
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>intersects</span>([<span style=color:#e6db74>&#39;a&#39;</span>, <span style=color:#e6db74>&#39;c&#39;</span>]))
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// [&#39;a&#39;]
</span></span></span></code></pre></div><p>These methods accept an array, or an <code>Observable&lt;Array></code> of items to compare against.</p><p>The module also included a <a href=https://tanepiper.github.io/rxjs-primitives/modules/array.html#binarysearch target=_blank>binarySearch</a>
operator which returns
a custom <a href=https://tanepiper.github.io/rxjs-primitives/modules/array.html#binarysearchresult target=_blank>BinarySearchResult</a>
tuple.</p><h3 id=rxjs-boolean>rxjs-boolean</h3><blockquote><p>npm install @tinynodes/rxjs-boolean</p></blockquote><p>A new <a href=https://en.wikipedia.org/wiki/Luhn_algorithm target=_blank>Luhn algorithm</a>
operator <code>luhnCheck</code> is provided that does validation on
numbers such as credit cards, ID cards and other value schemes that use the check.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>fromString</span>(<span style=color:#e6db74>&#39;4485275742308327&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>luhnCheck</span>())
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// true, this is a valid credit card
</span></span></span></code></pre></div><h3 id=rxjs-number>rxjs-number</h3><blockquote><p>npm install @tinynodes/rxjs-number</p></blockquote><p><code>inRange</code> / <code>outOfRange</code> and <code>filterInRange</code> / <code>filterOutOfRange</code> both all two numbers, the filter methods return the value from the source observable within the range of those values,
while the other methods return a boolean value if in range. An optional third value will include/exclude the range value
based on the method</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>fromNumber</span>([<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>11</span>])
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>filterInRange</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>))
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// [0, 1, 2, 10]
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Passing true as the third parameter, the range numbers will also be excluded
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fromNumber</span>([<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>11</span>])
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>filterInRange</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>, <span style=color:#66d9ef>true</span>))
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// [1, 2]
</span></span></span></code></pre></div><h3 id=rxjs-string>rxjs-string</h3><blockquote><p>npm install @tinynodes/rxjs-string</p></blockquote><p>New operators such as <a href=https://tanepiper.github.io/rxjs-primitives/modules/string.html#titleize target=_blank>titleize</a>
, <a href=https://tanepiper.github.io/rxjs-primitives/modules/string.html#repeat target=_blank>repeat</a>
and
<a href=https://tanepiper.github.io/rxjs-primitives/modules/string.html#match target=_blank>match</a>
add new utility features for strings. Where they can they also support localisation:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>fromString</span>(<span style=color:#e6db74>&#39;Mary had a little lamb&#39;</span>)
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>titleize</span>())
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// &#39;Mary Had A Little Lamb&#39;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fromString</span>(<span style=color:#e6db74>&#39;Mary had ä little lamb&#39;</span>)
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>titleize</span>(<span style=color:#e6db74>&#39;de-DE&#39;</span>))
</span></span><span style=display:flex><span> .<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>) <span style=color:#75715e>// &#39;Mary Had Ä Little Lamb&#39;
</span></span></span></code></pre></div><h3 id=rxjs-utility>rxjs-utility</h3><blockquote><p>npm install @tinynodes/rxjs-utility</p></blockquote><p>The <a href=https://tanepiper.github.io/rxjs-primitives/modules/utility.html target=_blank>utility module</a>
contains some specialised tap operators such as <code>tapIf</code>, <code>startWithTap</code> and <code>tapOnSubscribe</code>.
These provide a way to do side effects. With <code>startWithTap</code> it can be used with Angular to do a form touch, also <code>tapOnSubscribe</code> will
fire when there is a subscription to the Observable:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#75715e>// Only touch on first value change
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>valueChange</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span> <span style=color:#a6e22e>startWithTap</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>onTouch</span>())
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Fire when a component subscribes to the service bus
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>serviceBus</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tapOnSubscribe</span>((<span style=color:#a6e22e>name</span>: <span style=color:#66d9ef>string</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`New Subscription to </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>))
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>()
</span></span></code></pre></div><p>The <code>tapIf</code> will only fire if a passed method result is truthy:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>fromNumber</span>([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]).<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>tapIf</span>((<span style=color:#a6e22e>val</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>val</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>), (<span style=color:#a6e22e>val</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>val</span>)
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>() <span style=color:#75715e>// 2, 4, 6
</span></span></span></code></pre></div><p>The last operator is <code>mapIfSource</code> which might be a bit of a weird one but I hope might become useful.</p><p>The operator takes the value from the source and passes to a predicate method, and depending on the result will <code>map</code> the
result of a passed method. A simple example would be:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>fromNumber</span>([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>6</span>]).<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>mapIfSource</span>(
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>val</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>val</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>    (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>val</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>  )
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>() <span style=color:#75715e>// 20, 20, 60 40, 100, 60
</span></span></span></code></pre></div><p>Here, if the result of the predicate is true multiply by 10, otherwise by 20. The method is typed to allow different return values
based on the result (so you will have to handle the type later). For example we could even turn it into a
FizzBuzz operator:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fizzbuzz</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>OperatorFunction</span>&lt;<span style=color:#f92672>number</span>, <span style=color:#a6e22e>string</span> <span style=color:#960050;background-color:#1e0010>|</span> <span style=color:#a6e22e>number</span>&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> (<span style=color:#a6e22e>source</span>: <span style=color:#66d9ef>Observable</span>&lt;<span style=color:#f92672>number</span>&gt;) <span style=color:#f92672>=&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>source</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>mapIfSource</span>&lt;<span style=color:#f92672>number</span>, <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>number</span>&gt;(
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> (<span style=color:#a6e22e>value</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>`FizzBuzz`</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;Fizz&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;Buzz&#39;</span>),
</span></span><span style=display:flex><span>        (<span style=color:#a6e22e>value</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>     )
</span></span><span style=display:flex><span>  );
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// And now we use it in our code
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fromNumber</span>([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>16</span>]).<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>fizzbuzz</span>(),
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>() <span style=color:#75715e>// 1, &#39;Fizz&#39;, &#39;Buzz&#39;, &#39;FizzBuzz&#39;, 16
</span></span></span></code></pre></div><p>Hopefully you&rsquo;ll find these operators useful and feel free to leave feedback and suggestions.</p></div></div><div class=post><div class=post-heading><h1><a href=https://tane.dev/2020/05/publishing-npm-libraries-using-nx-and-github-actions/>Publishing NPM Libraries using NX and Github Actions</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: May 7, 2020</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 2200 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 10 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/nx>NX</a>
<a class=flex-item href=https://tane.dev/tags/github>Github</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a>
<a class=flex-item href=https://tane.dev/tags/monorepo>Monorepo</a></div></div><div class=post-content><p>This week I released version 1.0 of <a href=https://tanepiper.github.io/rxjs-primitives/ target=_blank>RxJS Primitives</a>
to NPM - but the
journey to get there was not as easy as I hoped.</p><p>In the past I&rsquo;ve used <a href=https://circleci.com/ target=_blank>CircleCI</a>
and at work I use <a href=https://www.jenkins.io/ target=_blank>Jenkins</a>
but with this project I wanted to try out <a href=https://github.com/features/actions target=_blank>Github Actions</a>
.</p><p>After some trial an error (and many failed builds) I managed to get the workflow working, I&rsquo;ve decided to share here the
steps taken to hopefully save you from the same pain.</p><h2 id=setting-up-your-monorepo>Setting up your monorepo</h2><p>The <a href=https://nx.dev/ target=_blank>NX</a>
CLI is a set of tools that make managing your repository of JavaScript and TypeScript code
easy. Originally built on top of the <a href=https://cli.angular.io/ target=_blank>Angular CLI</a>
the tooling now supports more project types
including Node, React and Web Components.</p><p>In my day-job most of my work is building Angular Enterprise applications, but I also work on my own open source
software and in both cases I use NX, including using it to publish Angular and TypeScript libraries to NPM.</p><p>Each way of setting this up is subtly different. In this example I&rsquo;ll show the steps of how I built a pipeline for
releasing my TypeScript RxJS library.</p><p>The easiest way to start is to create your repo
using <a href=https://www.npmjs.com/package/create-nx-workspace target=_blank><code>create-nx-workspace</code></a></p><blockquote><p><code>npx create-nx-workspace &lt;project-name></code></p></blockquote><p>When running this, you will be asked a few questions depending on your setup. For <code>RxJS Primitives</code> I used a plain
workspace, and then once created I added <a href=https://www.npmjs.com/package/@nrwl/node target=_blank><code>@nrwl/node</code></a>
to the project. The
default <code>@nrwl/workspace</code>
plugin allows the creation of libraries, but does not provide a publishable output (adding <code>package.json</code>) as an option.</p><p>Once set up you can now create libraries that can be built and published as NPM modules, using the <code>@nrwl/node</code> plugin
type to create them. For <code>rxjs-string</code> I used:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>&gt; nx g @nrwl/node:library --name<span style=color:#f92672>=</span>string --directory<span style=color:#f92672>=</span>rxjs --publishable
</span></span></code></pre></div><p>If it&rsquo;s an Angular library use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>&gt; nx g @nrwl/angular:library --name<span style=color:#f92672>=</span>my-component --directory<span style=color:#f92672>=</span>ngx --publishable
</span></span></code></pre></div><p>After a few seconds, inside the <code>libs</code> folder will be a default output of a TypeScript library, with
various <code>tsconfig.json</code> files for testing and building, a <a href=https://jestjs.io/ target=_blank>Jest</a>
config for unit testing,
a <code>index.ts</code> file as the entry point and <code>package.json</code> for publishing.</p><blockquote><p>One issue with <code>nx</code> is that with this configuration in the <code>package.json</code> you&rsquo;ll find a 2-level
name for your library (e.g. <code>@tinynodes/rxjs-string</code>) however in the root <code>tsconfig.json</code> file you&rsquo;ll see the following
in the <code>paths</code> property</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;paths&#34;</span>: {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;@tinynodes/rxjs/string&#34;</span>: [
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#34;libs/rxjs/string/src/index.ts&#34;</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>If you are only using this library internally it&rsquo;s not really an issue, but when you intend to publish the library I
recommend changing the path to <code>@tinynodes/rxjs-string</code> to match the NPM import path.</p><h2 id=preparing-for-publishing>Preparing for publishing</h2><p>Once you have developed your library, it&rsquo;s time to publish to NPM! First of all, make sure your public API
(Functions, Classes, and Types) are exported in the library <code>index.ts</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#75715e>// index.ts
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>myFactoryFunction</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./libs/factory&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>MyThing</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./classes/my-thing&#39;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>export</span> { <span style=color:#a6e22e>MyInterface</span>, <span style=color:#a6e22e>SOME_CONSTANT</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;./types/thing-types&#39;</span> 
</span></span></code></pre></div><p>To see the output of this library you can run <code>nx build library-name</code>, this will output a NPM module to the <code>dist</code>
folder.</p><h2 id=setting-up-github-actions-for-pull-requests>Setting up Github Actions for Pull Requests</h2><p>For an open-source library on GitHub, it&rsquo;s good practice for you to get pull requests from other developers, and to have
confidence in those PRs having a pull request checker is ideal.</p><p>First create a folder <code>.github</code> at the root of your workspace, and inside the <code>workflows</code> folder. This is the folder
that GitHub checks to see if there are any YAML files containing action flows.</p><p>Create a file <code>pr_on_master.yml</code> and inside this file set up the following steps:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># File for Pull Request on master branch</span>
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>PR on master</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># When a PR is opened to master</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [ <span style=color:#ae81ff>opened, reopened, synchronize ]</span>
</span></span></code></pre></div><p>This first section provides the name and triggers for when the action runs: when a pull request opened or re-opened
against <code>master</code>.</p><p>Next the steps need set up:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>jobs</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>build</span>:
</span></span><span style=display:flex><span>    <span style=color:#75715e># Setup OS and Node Version</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>runs-on</span>: <span style=color:#ae81ff>ubuntu-latest</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>strategy</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>matrix</span>:
</span></span><span style=display:flex><span>        <span style=color:#75715e># Latest nodes only</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>node-version</span>: [ <span style=color:#ae81ff>13.</span><span style=color:#ae81ff>x ]</span>
</span></span></code></pre></div><p>This sets up a Github Action runner and makes sure NodeJS 13 is installed. Here you can add more versions and run
parallel tests against different versions if you plan to support more than one.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Define Steps</span>
</span></span><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># Checkout code</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ref</span>: <span style=color:#ae81ff>${{ github.event.pull_request.head.ref }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>fetch-depth</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Use Node.js ${{ matrix.node-version }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/setup-node@v1</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>node-version</span>: <span style=color:#ae81ff>${{ matrix.node-version }}</span>
</span></span></code></pre></div><p>The first two steps first check out the code from the pull request branch, and then sets up NodeJS to run.</p><p>The next piece of step was the part of setting up the pipeline that took the longest to fix.</p><p>To use the <code>nx affected</code> commands it needs a base branch to compare changes against - by default Github checkout does
not pull all the branches, only the current one - and this includes the master branch. This command tells git to pull
the master branch from the origin:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#75715e># Make sure we have all branches</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Fetch other branches</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: <span style=color:#ae81ff>git fetch --no-tags --prune --depth=5 origin master</span>
</span></span></code></pre></div><p>Finally, we run some NPM command for installing the dependencies, running linting and test coverage.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Install environment</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm ci</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Run lint</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run affected:lint -- --base=&#34;origin/master&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Tests coverage</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run affected:test -- --base=&#34;origin/master&#34; --codeCoverage</span>
</span></span></code></pre></div><p>Using the affected commands, the pipeline will only run linting and testing against libraries that have changed against
the master branch. More steps such as <a href=https://sonarqube.org target=_blank>SonarQube</a>
or other webhooks can be performed here.</p><h3 id=publishing-to-npm>Publishing to NPM</h3><p>When publishing libraries, there&rsquo;s a few additional steps needed before we write the pipeline. First of all we need two
access tokens, one for NPM and one for GitHub.</p><h4 id=npm-token>NPM Token</h4><p>The NPM token will be used to publish the library to the public NPM registry. Log into NPM and under your profile go to
the &ldquo;Auth Tokens&rdquo;
section and create a new token with &ldquo;Publish&rdquo; access. Next go to your Github repository and under &ldquo;Settings -> Secrets&rdquo;
add a new token called <code>NPM_AUTH_TOKEN</code> and paste in the value.</p><blockquote><p>If publishing to a private registry follow it&rsquo;s instructions on generating an API token.</p></blockquote><h4 id=github-token>Github Token</h4><p>To publish changes back to GitHub from the pipeline you also need a personal access token - this can be created under
your account settings in &ldquo;Developer Settings -> Personal Access Token&rdquo;. The only permissions you need to give this token
are the <code>repo</code> permissions.</p><p>Add this under &ldquo;Settings -> Secrets&rdquo; as <code>ACTION_AUTH_TOKEN</code> (it seems you cannot name them with <code>GITHUB_</code> in the name at
all) 🤷‍♂️</p><h4 id=setting-up-the-action>Setting up the action</h4><p>Like before we are going to add a YAML file to the <code>.github/workflows</code> folder - this time called <code>publish.yml</code></p><p>First set the action up to trigger only when a PR is closed on <code>master</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>Merge on master</span>
</span></span><span style=display:flex><span><span style=color:#f92672>on</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>pull_request</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>branches</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>types</span>: [ <span style=color:#ae81ff>closed ]</span>
</span></span></code></pre></div><p>The <code>job</code> section is the same as above, but for the steps there is a slight change - to allow merges to master that *
don&rsquo;t* trigger a release, each command will be wrapped in a <code>if</code> block this block checks the commit message for the
string <code>[skip-ci]</code> to avoid running these tasks (unfortunatly it seems you can&rsquo;t just put a block around the entire set
of steps so has to be added to all of them)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>steps</span>:
</span></span><span style=display:flex><span>  <span style=color:#75715e># Checkout code</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Checkout Code</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event.pull_request.merged == true &amp;&amp; contains(github.event.commits[0].message, &#39;[skip-ci]&#39;) == false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>actions/checkout@v2</span>
</span></span></code></pre></div><p>Instead of running lint and test, we&rsquo;ll now run a set of different tasks - hold on tight because we&rsquo;re about to dive
into some <code>bash</code> code!</p><h4 id=deployment-step>Deployment Step</h4><p>In our <code>publish.yaml</code> add the following step which first exports our registry publishing setting with the auth token we
set up earlier, then we call our publish bash script</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Deploy</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event.pull_request.merged == true &amp;&amp; contains(github.event.commits[0].message, &#39;[skip-ci]&#39;) == false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>NPM_AUTH_TOKEN</span>: <span style=color:#ae81ff>${{ secrets.NPM_AUTH_TOKEN }}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      npm config set //registry.npmjs.org/:_authToken=$NPM_AUTH_TOKEN
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      ./.github/scripts/publish-libraries.sh</span>
</span></span></code></pre></div><p>Create the <code>.github/scripts/publish-libraries.sh</code> file and make sure it&rsquo;s set to executable by
typing <code>chmod +x .github/scripts/publish-libraries.sh</code> before committing the script.</p><p>The first part of the script is setting up our variables and <code>getBuildType</code> function to check what type of release we
are doing. It&rsquo;s good to use <a href=https://semver.org/ target=_blank>SemVer</a>
to publish based on changes that happen in the library and
with this function using the following words in the <strong>MERGE COMMIT</strong> message will determine the release type.</p><p>For example: <code>(fix): Fixed that annoying bug in issue #123</code> will set the release type to <code>patch</code>. The default is <code>minor</code>
. Using <code>(feat)</code> will make a major change.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>set -o errexit -o noclobber -o nounset -o pipefail
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># This script uses the parent version as the version to publish a library with</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>getBuildType<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  local release_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;minor&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;feat&#34;</span>* <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    release_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;major&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>elif</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;fix&#34;</span>* <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;docs&#34;</span>* <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;chore&#34;</span>* <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    release_type<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;patch&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;</span>$release_type<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PARENT_DIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PWD<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>ROOT_DIR<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;.&#34;</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;Removing Dist&#34;</span>
</span></span><span style=display:flex><span>rm -rf <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>ROOT_DIR:?<span style=color:#e6db74>}</span><span style=color:#e6db74>/dist&#34;</span>
</span></span><span style=display:flex><span>COMMIT_MESSAGE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>git log -1 --pretty<span style=color:#f92672>=</span>format:<span style=color:#e6db74>&#34;%s&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>RELEASE_TYPE<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>1<span style=color:#66d9ef>:-$(</span>getBuildType <span style=color:#e6db74>&#34;</span>$COMMIT_MESSAGE<span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>DRY_RUN<span style=color:#f92672>=</span><span style=color:#e6db74>${</span>DRY_RUN<span style=color:#66d9ef>:-</span><span style=color:#e6db74>&#34;False&#34;</span><span style=color:#e6db74>}</span>
</span></span></code></pre></div><p>The script also cleans up the dist folder, and has an optional <code>DRY_RUN</code> to set if you want to test the pipeline before
release.</p><p>After this add the following:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>AFFECTED<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>node node_modules/.bin/nx affected:libs --plain --base<span style=color:#f92672>=</span>origin/master~1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$AFFECTED<span style=color:#e6db74>&#34;</span> !<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  cd <span style=color:#e6db74>&#34;</span>$PARENT_DIR<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;Copy Environment Files&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> IFS<span style=color:#f92672>=</span> read -r -d <span style=color:#e6db74>$&#39; &#39;</span> lib; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Setting version for </span>$lib<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    cd <span style=color:#e6db74>&#34;</span>$PARENT_DIR<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    cd <span style=color:#e6db74>&#34;</span>$ROOT_DIR<span style=color:#e6db74>/libs/</span><span style=color:#e6db74>${</span>lib/-//<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    npm version <span style=color:#e6db74>&#34;</span>$RELEASE_TYPE<span style=color:#e6db74>&#34;</span> -f -m <span style=color:#e6db74>&#34;RxJS Primitives </span>$RELEASE_TYPE<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Building </span>$lib<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    cd <span style=color:#e6db74>&#34;</span>$PARENT_DIR<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    npm run build <span style=color:#e6db74>&#34;</span>$lib<span style=color:#e6db74>&#34;</span> -- --prod --with-deps
</span></span><span style=display:flex><span>    wait
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span> <span style=color:#f92672>&lt;&lt;&lt;</span><span style=color:#e6db74>&#34;</span>$AFFECTED<span style=color:#e6db74> &#34;</span> <span style=color:#75715e># leave space on end to generate correct output</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  cd <span style=color:#e6db74>&#34;</span>$PARENT_DIR<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>while</span> IFS<span style=color:#f92672>=</span> read -r -d <span style=color:#e6db74>$&#39; &#39;</span> lib; <span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$DRY_RUN<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;False&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;Publishing </span>$lib<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>      npm publish <span style=color:#e6db74>&#34;</span>$ROOT_DIR<span style=color:#e6db74>/dist/libs/</span><span style=color:#e6db74>${</span>lib/-//<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> --access<span style=color:#f92672>=</span>public
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;Dry Run, not publishing </span>$lib<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    wait
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>done</span> <span style=color:#f92672>&lt;&lt;&lt;</span><span style=color:#e6db74>&#34;</span>$AFFECTED<span style=color:#e6db74> &#34;</span> <span style=color:#75715e># leave space on end to generate correct output</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;No Libraries to publish&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p>This part of the script allows us to control the build and release - the first line gets a single line list of affected
libraries from the current <code>master</code> to the last <code>HEAD</code> in <code>master</code> - if you use only PRs to make changes into <code>master</code>
this is very effective - but can break if you make changes directly to <code>master</code>.</p><p>This is done instead of using <code>nx affected</code> as there is currently no task for publishing, so this gives a way to provide
a loop for both building and publishing.</p><p>Both <code>while</code> loops parses this string and splits on the space to allow a loop to be run.</p><blockquote><p>In each loop there is a string replacement <code>${lib/-//}</code> - this changes the library name (e.g. <code>rxjs-string</code>) into a path (<code>rxjs/string</code>)</p></blockquote><p>The first <code>while</code> loop ensures we are in the correct directory and does <code>npm version</code> - bumping the <code>package.json</code> for
release - it then runs the build task for production, and ensures any dependencies are also build.</p><p>The second <code>while</code> loop iterates over the same list but runs the <code>npm publish</code> command in each directory, setting the
access to public.</p><h4 id=congratulations>Congratulations</h4><p>If you&rsquo;ve made it this far, well done - this is quite a long post! At this point your pipeline should have successfully
published your NPM module for other developers to use! We&rsquo;re not done yet though!</p><p>Before running this we are going to add some additional steps so that we can publish documentation and changes back to
Github:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Build Docs</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event.pull_request.merged == true &amp;&amp; contains(github.event.commits[0].message, &#39;[skip-ci]&#39;) == false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: <span style=color:#ae81ff>npm run docs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Commit files</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event.pull_request.merged == true &amp;&amp; contains(github.event.commits[0].message, &#39;[skip-ci]&#39;) == false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      git config --local user.email &#34;action@github.com&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      git config --local user.name &#34;GitHub Action&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      git add .
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      git commit -m &#34;Release [skip-ci]&#34; -a || true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>Push changes</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>if</span>: <span style=color:#ae81ff>github.event.pull_request.merged == true &amp;&amp; contains(github.event.commits[0].message, &#39;[skip-ci]&#39;) == false</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>uses</span>: <span style=color:#ae81ff>ad-m/github-push-action@master</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>with</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>github_token</span>: <span style=color:#ae81ff>${{ secrets.ACTION_AUTH_TOKEN }}</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>tags</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>force</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>For RxJS Primitives I used <a href=https://typedoc.org/ target=_blank>TypeDoc</a>
to generate static content to the <code>docs</code> folder, which is
then used by GitHub Pages, but here you can set up whatever documentation system you prefer.</p><p>Once the docs have been generated we then commit all changes including the <code>package.json</code> version bumps back to git and
then finally push it back to <code>master</code> using the GitHub token generated earlier.</p><p>Within a few seconds your GitHub Page should update with the latest content, the master branch reflect all changes made.</p><p>That&rsquo;s a wrap! You&rsquo;ve now successfully published your TypeScript library for other developers to use, along with
documentation.</p><p>If you&rsquo;ve found this article useful, let me know - and if you find any issues or improvements please get in touch!</p></div></div><div class=post><div class=post-heading><h1><a href=https://tane.dev/2020/04/rxjs-primitives-operators-for-mutating-and-filtering-primitives/>RxJS Primitives - Operators for mutating and filtering primitives</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: Apr 23, 2020</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 400 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 2 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/typescript>TypeScript</a>
<a class=flex-item href=https://tane.dev/tags/rxjs>RxJS</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a>
<a class=flex-item href=https://tane.dev/tags/ecmascript>ECMAScript</a></div></div><div class=post-content><p>Today I&rsquo;ve published a new set of libraries to NPM - <a href=https://github.com/tanepiper/rxjs-primitives target=_blank>RxJS Primitives</a>
.</p><p>These are based on some operators I&rsquo;ve collected over the last year, and some additional ones I&rsquo;ve started adding.
Most are based around ECMASCript objects such as <code>String</code>, <code>Number</code> and <code>Boolean</code> but also includes some useful
utility operators.</p><p>Over the coming weeks I&rsquo;ll add more operators, both based on ECMAScript methods and custom functions that I have found useful.</p><p>The following modules are on NPM:</p><h2 id=rxjs-string>rxjs-string</h2><p><a href=https://www.npmjs.com/package/@tinynodes/rxjs-string target=_blank>@tinynodes/rxjs-string</a>
operators that are built around the <code>String</code> object in ECMAScript, for example with <code>toUpperCase</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>from</span>([<span style=color:#e6db74>&#39;hello&#39;</span>, <span style=color:#e6db74>&#39;world&#39;</span>]).<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>toUpperCase</span>()
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>value</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>value</span>)) <span style=color:#75715e>// [&#39;HELLO&#39;, &#39;WORLD&#39;]
</span></span></span></code></pre></div><p>There are also some boolean value operators such as <code>endsWith</code> and extraction operators like <code>charAt</code>, with plans
to add more useful utilities. For example <code>endWith</code> returns a boolean value, but I also want to include an <code>endsWith</code>
that returns the original value instead (like <code>filter</code>).</p><h2 id=rxjs-number>rxjs-number</h2><p><a href=https://www.npmjs.com/package/@tinynodes/rxjs-number target=_blank>@tinynodes/rxjs-number</a>
operators that are built around the <code>Number</code> object in ECMAScript, for example <code>parseFloat</code>/<code>parseInt</code> and <code>isNaN</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#66d9ef>from</span>([<span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#e6db74>&#39;1.2&#39;</span>, <span style=color:#e6db74>&#39;3.14&#39;</span>]).<span style=color:#a6e22e>pipe</span>(parseInt()).<span style=color:#a6e22e>subscribe</span>(<span style=color:#a6e22e>value</span> <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>value</span>)) <span style=color:#75715e>// [1, 2, 3]
</span></span></span></code></pre></div><p>This also includes <code>toString</code> which uses <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString target=_blank>Number.prototype.toLocaleString</a>
supports formatting such as currency.</p><h2 id=rxjs-boolean>rxjs-boolean</h2><p><a href=https://www.npmjs.com/package/@tinynodes/rxjs-boolean target=_blank>@tinynodes/rxjs-boolean</a>
operators that are built around the <code>Boolean</code> object in ECMAScript,
and are designed to help with filtering content from observables. Currently, there are two operators <code>firstTruthy</code> and <code>filterTruthy</code>.</p><p>In both cases these return the underlying value only if it&rsquo;s a truthy value in JavaScript, in the case of <code>firstTruthy</code> it only returns
the first value, while <code>filterTruthy</code> returns all truthy values.</p><h2 id=rxjs-utility>rxjs-utility</h2><p><a href=https://www.npmjs.com/package/@tinynodes/rxjs-utility target=_blank>@tinynodes/rxjs-utility</a>
is a custom module that provides some additional operators
that don&rsquo;t fit into the other packages but still have some usefulness.</p><p>Currently, there are two operators:</p><ul><li><code>startWithTap</code> - Will fire a callback method only on the first emission from an Observable</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>valueChanges</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>startWithTap</span>(() <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>form</span>.<span style=color:#a6e22e>touch</span>()),
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>()
</span></span></code></pre></div><ul><li><code>debounceWithQuery</code> - Debounces an input such as a text input and passes it to a method that returns a value from a query (such as a search)</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ts data-lang=ts><span style=display:flex><span><span style=color:#a6e22e>searchField</span>.<span style=color:#a6e22e>valueChange</span>.<span style=color:#a6e22e>pipe</span>(
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>debounceWithQuery</span>(<span style=color:#ae81ff>1000</span>, (<span style=color:#a6e22e>search</span>) <span style=color:#f92672>=&gt;</span> <span style=color:#a6e22e>http</span>.<span style=color:#66d9ef>get</span>(<span style=color:#e6db74>`/search?query=</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>search</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>))
</span></span><span style=display:flex><span>).<span style=color:#a6e22e>subscribe</span>()
</span></span></code></pre></div></div></div><div class=post><div class=post-heading><h1><a href=https://tane.dev/2019/05/ngx-editorjs-library-for-angular/>Ngx-EditorJS library for Angular</a></h1><div class=meta><i class="far fa-calendar-edit" title="The date when this post was originally published" aria-label="The date when this post was originally published"></i><span>&nbsp;Published: May 10, 2019</span>
|&nbsp;<i class="far fa-pencil" title="The number of semi-coherent words I managed to produce" aria-label="The number of semi-coherent words I managed to produce"></i><span>~ 300 words</span>
|&nbsp;<i class="far fa-clock" title="Time is an illusion. Lunchtime doubly so" aria-label="Time is an illusion. Lunchtime doubly so"></i><span>~ 2 minutes reading time</span></div><div class=tags title="Click the links in this to go to a page based on a tag value" aria-label="Click the links in this to go to a page based on a tag value"><a class=flex-item href=https://tane.dev/tags/typescript>TypeScript</a>
<a class=flex-item href=https://tane.dev/tags/angular>Angular</a>
<a class=flex-item href=https://tane.dev/tags/npm>NPM</a>
<a class=flex-item href=https://tane.dev/tags/library>Library</a></div></div><div class=post-content><p>Today I have published my first full Angular module - <code>@tinynodes/ngx-editorjs</code> on <a href=https://www.npmjs.com/package/@tinynodes/ngx-editorjs target=_blank>NPM</a>
.</p><p>The module is a set of features for Angular (7+) to create and control <a href=https://editorjs.io target=_blank>EditorJS</a>
instances.</p><p>A <a href=https://tinynodes-ngx.firebaseapp.com/ngx-editorjs-demo target=_blank>demo application</a>
is available to see the editor in action, and the source is also available in the <a href=https://github.com/tanepiper/ngx-tinynodes target=_blank><code>@tinynodes</code> monorepo</a>
.</p><h2 id=included-features>Included Features</h2><p>The library exports several features once the <code>NgxEditorJSModule</code> has been included in your project.</p><h4 id=ngxeditorjsdirective>NgxEditorJSDirective</h4><p>This is the main directive which can be used on any element with the <code>[ngxEditorJS]</code> selector and and <code>id</code> attribute.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;my-editor&#34;</span> <span style=color:#a6e22e>ngxEditorJS</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</span></span></code></pre></div><p>This will handle creating the editor instance via the <code>NgxEditorJSService</code></p><h4 id=ngxeditorjscomponent>NgxEditorJSComponent</h4><p>This component can be used in any Angular component using the <code>&lt;ngx-editorjs></code> tag. Again this component can take a set of blocks, it also provides a <code>holder</code> input for overriding the ID.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>ngx-editorjs</span> <span style=color:#960050;background-color:#1e0010>[</span><span style=color:#a6e22e>holder</span><span style=color:#960050;background-color:#1e0010>]=&#34;</span><span style=color:#a6e22e>holderProperty</span><span style=color:#960050;background-color:#1e0010>&#34;</span>&gt;&lt;/<span style=color:#f92672>ngx-editorjs</span>&gt;
</span></span></code></pre></div><h4 id=ngxeditorjsservice>NgxEditorJSService</h4><p>This service provides handling the life-cycle of the EditorJS instances, and exposes the underlying <a href=https://editorjs.io/api target=_blank>EditorJS API</a>
- in future releases more of the API will be exposed via service methods to make controlling the container easier.</p><p>The module is configurable and allows EditorJS plugins to be injected into the library - (see <a href=https://github.com/tanepiper/ngx-tinynodes/blob/master/libs/ngx-editorjs/README.md target=_blank>README.md</a>
) on how to do this in a AOT-friendly way.</p><h2 id=next-steps>Next Steps</h2><p>Before release I had to resolve an issue with AOT compiling and injecting EditorJS plugins - this means version <code>1.1.0</code> has already been released - now this is resolved I want support additional feature in the editor, as well as provide unit test coverage and better documentation and demo.</p><p>If you find any issues or have feature requests these can be left on the <a href=https://github.com/tanepiper/ngx-tinynodes/issues target=_blank>GitHub Issues</a>
page.</p></div></div><div class=text-center><ul class="pagination pagination-default"><li class=page-item><a href=https://tane.dev/tags/npm/ aria-label=First class=page-link role=button><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=https://tane.dev/tags/npm/ aria-label=Previous class=page-link role=button><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a href=https://tane.dev/tags/npm/ aria-label="Page 1" class=page-link role=button>1</a></li><li class="page-item active"><a aria-current=page aria-label="Page 2" class=page-link role=button>2</a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Next class=page-link role=button tabindex=-1><span aria-hidden=true>&#187;</span></a></li><li class="page-item disabled"><a aria-disabled=true aria-label=Last class=page-link role=button tabindex=-1><span aria-hidden=true>&#187;&#187;</span></a></li></ul></div></main></div><style>.taxonomy-title{padding-left:1rem}.taxonomy-title:before{font-family:'font awesome 5 pro';content:'\f02c';display:inline-block;padding-right:.5rem;vertical-align:middle;font-weight:900}</style></div><footer></footer><script src=https://tane.dev/vendor/rxjs.umd.min.cfc67dfcb1df9b0e06f96ac2e2bf29507e56ff70c80563ef778250b702add65b76253e3a28b4528f9baadca92b9b2d35f64884365ff4ae673dfeb3d0c3b61a91.js integrity="sha512-z8Z9/LHfmw4G+WrC4r8pUH5W/3DIBWPvd4JQtwKt1lt2JT46KLRSj5uq3Kkrmy019kiENl/0rmc9/rPQw7YakQ=="></script><script src=https://tane.dev/js/bundle.min.c218495446b0af055063d5a2d131d9bdbf1346a6d558d6843997c8c69e4e1f41106b5a32b053482d4fc6c6dd7c3ac1d18e0039a33506d68f311d5b6e37429eb4.js integrity="sha512-whhJVEawrwVQY9Wi0THZvb8TRqbVWNaEOZfIxp5OH0EQa1oysFNILU/Gxt18OsHRjgA5ozUG1o8xHVtuN0KetA==" defer></script><script async data-id=101405924 src=//static.getclicky.com/js></script></body></html>